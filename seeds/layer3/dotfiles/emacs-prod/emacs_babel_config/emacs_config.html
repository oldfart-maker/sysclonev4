<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-08-03 Sun 16:02 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="author" content="Mike Burns" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
</head>
<body>
<div id="content" class="content">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org19aadd6">1. Emacs Literate Config</a></li>
<li><a href="#org6ed464a">2. Environment</a></li>
<li><a href="#orgfa43d02">3. Core</a></li>
<li><a href="#org4c416db">4. Core-Extensions</a></li>
<li><a href="#org157b6c5">5. UI</a></li>
<li><a href="#org2d4ea99">6. Org</a></li>
<li><a href="#org7349c38">7. Email</a></li>
<li><a href="#org0a47733">8. Dev Environment</a></li>
<li><a href="#orgbe6fb47">9. System &amp; OS Integration</a></li>
<li><a href="#org1ccc26f">10. My Functions</a></li>
<li><a href="#orgfe213cd">11. Table of Contents / Manifest</a></li>
</ul>
</div>
</div>
<div id="outline-container-org19aadd6" class="outline-2">
<h2 id="org19aadd6"><span class="section-number-2">1.</span> Emacs Literate Config</h2>
<div class="outline-text-2" id="text-1">
<p>
The pattern due to limiations using :var with quoted strings
is to return a string using format + concat (if needed),
:results value with escaped quoted strings. This enables the
use of '<a id="orgae11bea"></a>' consistently for accessing variables. Consuming
code blocks will will require :noweb yes. :var is not used
at this time. The is enables a consitent approach for quoted
and non-quoted strings. This is the only way I could figure
out how to do this so that the approach was the same for quoted
and non-quoted strings.
</p>
</div>
</div>
<div id="outline-container-org6ed464a" class="outline-2">
<h2 id="org6ed464a"><span class="section-number-2">2.</span> Environment</h2>
<div class="outline-text-2" id="text-2">
<p>
Defines external environment variables and configurations used across modules.
Manually modify the `active-env` block below to switch between prod/dev environments.
</p>

<p>
Options emacs-prod | emacs-dev
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org777b454">
(format "\"%s\"" "emacs-prod")
</pre>
</div>

<p>
Set target os.
</p>

<p>
Options archlinux | windows
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org8ef88c5">(format "\"%s\"" "archlinux")  
</pre>
</div>

<p>
Variable definitions for those variables that can shared across all
modules and enviroments. These should be used judiciously.
All other variable definitions should be within their respective code blocks.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org249b2b6">(format "\"%s\"" "~/.config/emacs-common")
</pre>
</div>

<p>
Set evnrionment variables.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org65395f5">(setq my/env "emacs-prod")
(setq server-name "emacs-prod") 
</pre>
</div>

<p>
Starts emacs in server mode.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org0ea008e">(require 'server)
(unless (server-running-p)
   (server-start))
</pre>
</div>

<p>
Turn off yes/no prompt for evaluating org buffer.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="orga73275d">;; Turn of eval protection
(setq org-confirm-babel-evaluate nil)
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfa43d02" class="outline-2">
<h2 id="orgfa43d02"><span class="section-number-2">3.</span> Core</h2>
<div class="outline-text-2" id="text-3">
<p>
Core (native) emacs behavior configurtation. These setting should be the same across any of my hardware / os
environments (e.g. laptop, desktop, pi).
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org63b53a5">(setq inhibit-startup-screen t)
(setq inhibit-startup-message t)
(setq ring-bell-function 'ignore)
(setq make-backup-files nil)

;; Initialize package system
(require 'package)
(setq package-archives '(("melpa" . "https://melpa.org/packages/")
                          ("org" . "https://orgmode.org/elpa/")
                          ("elpa" . "https://elpa.gnu.org/packages/")))
(package-initialize)
(unless package-archive-contents
  (package-refresh-contents))

;; Ensure use-package is available
(unless (package-installed-p 'use-package)
  (package-install 'use-package))

(require 'use-package)
(setq use-package-always-ensure t)

;; Auto update packages
(use-package auto-package-update
  :custom
  (auto-package-update-interval 7)
  (auto-package-update-prompt-before-update t)
  (auto-package-update-hide-results t)
  :config
  (auto-package-update-maybe)
  (auto-package-update-at-time "09:00"))

;; Clean up configuration file locations
(use-package no-littering)

;; Ensure auto-save files go into no-littering's designated auto-save dir
(setq auto-save-file-name-transforms
      `((".*" ,(no-littering-expand-var-file-name "auto-save/") t)))

;; Make ESC quit prompts
(global-set-key (kbd "&lt;escape&gt;") 'keyboard-escape-quit)
</pre>
</div>
</div>
</div>
<div id="outline-container-org4c416db" class="outline-2">
<h2 id="org4c416db"><span class="section-number-2">4.</span> Core-Extensions</h2>
<div class="outline-text-2" id="text-4">
<p>
Core extenstions to native emacs behavior. Ideally these will be the same across all environments.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org6bc4261">;; Enable which-key for keybinding discovery
(use-package which-key
  :defer 0
  :diminish
  :config
  (which-key-mode))

;; Completion and search system
(use-package ivy
  :diminish
  :bind (("C-s" . swiper)
         :map ivy-minibuffer-map
         ("TAB" . ivy-alt-done)
         ("C-l" . ivy-alt-done)
         ("C-j" . ivy-next-line)
         ("C-k" . ivy-previous-line)
         :map ivy-switch-buffer-map
         ("C-k" . ivy-previous-line)
         ("C-l" . ivy-done)
         ("C-d" . ivy-switch-buffer-kill)
         :map ivy-reverse-i-search-map
         ("C-k" . ivy-previous-line)
         ("C-d" . ivy-reverse-i-search-kill))
  :config
  (ivy-mode 1))

(use-package counsel
  :bind (("C-M-j" . counsel-switch-buffer)
         :map minibuffer-local-map
         ("C-r" . counsel-minibuffer-history))
  :custom
  (counsel-linux-app-format-function #'counsel-linux-app-format-function-name-only)
  :config
  (counsel-mode 1))

(use-package ivy-rich
  :after counsel
  :init
  (ivy-rich-mode 1))

;; Use to prioritize command history based on usage.
(use-package ivy-prescient
:after counsel
:custom
(ivy-prescient-enable-filtering nil)
:config
;; Uncomment the following line to have sorting remembered across sessions!
;(prescient-persist-mode 1)
(ivy-prescient-mode 1))

(use-package helpful
  :custom
  (counsel-describe-function-function #'helpful-callable)
  (counsel-describe-variable-function #'helpful-variable)
  :bind
  ([remap describe-function] . counsel-describe-function)
  ([remap describe-command] . helpful-command)
  ([remap describe-variable] . counsel-describe-variable)
  ([remap describe-key] . helpful-key))
</pre>
</div>
</div>
</div>
<div id="outline-container-org157b6c5" class="outline-2">
<h2 id="org157b6c5"><span class="section-number-2">5.</span> UI</h2>
<div class="outline-text-2" id="text-5">
<p>
UI configuration. Use the for frame / window decorations.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org4afc465">     ;; Font sizing defaults for UI scaling (override per-host if needed)
     (defvar my/default-font-size 100)
     (defvar my/default-variable-font-size 100)

     ;; Frame transparency defaults
     (defvar my/frame-transparency '(90 . 90))

     ;; Disable unnecessary UI elements
     (scroll-bar-mode -1)
     (tool-bar-mode -1)
     (tooltip-mode -1)
     (menu-bar-mode -1)
     (set-fringe-mode 10)

     ;; Set up the visible bell
     (setq visible-bell t)

     ;; Show column and line numbers
     (column-number-mode)
     (global-display-line-numbers-mode t)

     ;; Set frame font and theme
     (set-face-attribute 'default nil :font "JetBrains Mono" :height my/default-font-size)
     (set-face-attribute 'fixed-pitch nil :font "Fira Code Retina" :height my/default-font-size)
     (set-face-attribute 'variable-pitch nil :font "Cantarell" :height my/default-variable-font-size :weight 'regular)

     ;; Apply frame transparency
     (set-frame-parameter (selected-frame) 'alpha my/frame-transparency)
     (add-to-list 'default-frame-alist `(alpha . ,my/frame-transparency))

     ;; Icons and modeline
     (use-package all-the-icons)

     (use-package doom-themes
     :init (load-theme 'doom-palenight t))

     (use-package doom-modeline
       :init (doom-modeline-mode 1)
       :custom ((doom-modeline-height 15)))

     ;; Shows window numbers to select to change window
     (use-package ace-window
     :ensure t
     :bind (("M-o" . ace-window)))

     ;; Focus follows mouse
   (setq mouse-autoselect-window t)

    ;; Setup window borders like wtm
   (window-divider-mode 1)
   (setq window-divider-default-places t)
   (setq window-divider-default-bottom-width 1)
   (setq window-divider-default-right-width 1)

   ;; Set all borders to orange
  (set-face-attribute 'window-divider nil :foreground "orange")
  (set-face-attribute 'vertical-border nil :foreground "orange")

  ;; Mode line borders - also orange
  (set-face-attribute 'mode-line nil
                    :background "#4c566a"
                    :foreground "#eceff4"
                    :box '(:line-width 1 :color "orange"))

  (set-face-attribute 'mode-line-inactive nil
                    :background "#2e3440"
                    :foreground "#88909f"
                    :box '(:line-width 1 :color "orange"))

;;  Window shading - active window much darker
  (defvar my-active-window-background "#000000")    ; Very dark for active
  (defvar my-inactive-window-background "#2a2a2a")  ; Lighter for inactive

  (defun my-apply-window-shading ()
  "Apply shading - active window darker, inactive lighter."
     (dolist (window (window-list))
       (with-current-buffer (window-buffer window)
         (face-remap-reset-base 'default)
         (if (eq window (selected-window))
             ;; Active window - much darker
             (face-remap-add-relative 'default :background my-active-window-background)
           ;; Inactive windows - lighter
           (face-remap-add-relative 'default :background my-inactive-window-background)))))

  ;; Apply shading on window changes
  (add-hook 'window-selection-change-functions 
          (lambda (&amp;rest _) (my-apply-window-shading)))

  ;; Protect settings from being overridden
  (defun my-protect-window-settings (&amp;rest _)
     (when window-divider-mode
       (setq window-divider-default-bottom-width 1)
       (setq window-divider-default-right-width 1))
     (set-face-attribute 'window-divider nil :foreground "orange")
     (set-face-attribute 'vertical-border nil :foreground "orange")
     (my-apply-window-shading))

  (advice-add 'load-theme :after #'my-protect-window-settings)

  ;; Initialize everything
  (my-apply-window-shading)

  ;; End of Window Configuration
  (put 'erase-buffer 'disabled nil)    
</pre>
</div>
</div>
</div>
<div id="outline-container-org2d4ea99" class="outline-2">
<h2 id="org2d4ea99"><span class="section-number-2">6.</span> Org</h2>
<div class="outline-text-2" id="text-6">
<p>
Dedicated section for Org due to its scope of potential use and integration with emacs native.
</p>

<p>
Random notes, commands, quotes, etc. file.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="orgff12b02">(format "\"%s\"" "~/Documents/stuff/random_notes.org")
</pre>
</div>

<p>
Random notes function.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package org
       :defer t )

 (setq my/random-notes-file "~/Documents/stuff/random_notes.org")

   ;; Org Capture Template
   (setq org-capture-templates
         '(("r" "Random quick note"
            entry
            (file+headline my/random-notes-file "Inbox")
            "* %U %?\n  :tags: %^{Tags}\n"
            :empty-lines 1)))
   (global-set-key (kbd "C-c r") 'org-capture)
</pre>
</div>

<p>
Enable python code blocks in babel.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(org-babel-do-load-languages
'org-babel-load-languages
'((python . t)))
</pre>
</div>
</div>
</div>
<div id="outline-container-org7349c38" class="outline-2">
<h2 id="org7349c38"><span class="section-number-2">7.</span> Email</h2>
<div class="outline-text-2" id="text-7">
<p>
Dedicated section for email due to its scope of potential use and integration with emacs native.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp" id="orga2584dd">(format "\"%s\"" "~/Maildir/yahoo")
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org0c6c412">(format "\"%s\"" "mkburns61@yahoo.com")    
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org0de5d54">(format "\"%s\"" "Mike Burns")    
</pre>
</div>

<p>
Big brother contacts database location.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org2b0faf9">(format "\"%s\"" (concat "~/.config/emacs-common""/bbdb"))
</pre>
</div>


<div class="org-src-container">
<pre class="src src-emacs-lisp">
(add-to-list 'load-path "/usr/share/emacs/site-lisp/mu4e")
(require 'mu4e)

(setq mu4e-maildir "~/Maildir/yahoo") ;; or wherever your Maildir lives
(require 'mu4e)

(setq user-mail-address "mkburns61@yahoo.com")
(setq user-full-name "Mike Burns")

(setq send-mail-function 'sendmail-send-it
      message-send-mail-function 'sendmail-send-it
      sendmail-program "/usr/bin/msmtp"
      mail-specify-envelope-from t
      mail-envelope-from 'header)

(defun my/run-mbsync ()
  "Run mbsync to sync mail."
  (start-process-shell-command "mbsync" "*mbsync*" "mbsync -a"))

;; Run every 5 minutes (adjust as needed)
(run-at-time "5 min" 300 #'my/run-mbsync)

(setq mu4e-update-interval 300)  ;; 5 minutes

;; Setup image preview
(setq mu4e-view-show-images t)
(setq mu4e-view-use-gnus t) 
(setq mu4e-view-image-max-width 800)
(setq mu4e-view-show-addresses 't)

(setq shr-inhibit-images nil)
(setq gnus-inhibit-images nil)

(defun my-mu4e-view-inline-images ()
  "Show images automatically in mu4e."
  (when (fboundp 'shr-put-image)
    (setq mu4e-view-show-images t)))

(setq url-privacy-level 'low)

(defun my/mu4e-view-message-no-focus ()
  "View the current message in another window without changing focus."
  (interactive)
  (let ((msg (mu4e-message-at-point)))
    (when msg
      (save-selected-window
        (mu4e-view msg)))))

(with-eval-after-load 'mu4e
  (define-key mu4e-headers-mode-map (kbd "V") #'my/mu4e-view-message-no-focus))

;; Open email in a dedicated frame for better workflow.
(defun my/mu4e-open-in-dedicated-frame ()
  "Open mu4e in a dedicated frame named 'mu4e'."
  (interactive)
  (let ((bufname "*mu4e*"))
    (if (get-buffer bufname)
        ;; If buffer already exists, raise the frame or switch to it
        (progn
          (select-frame-set-input-focus
           (window-frame (get-buffer-window bufname))))
      ;; Else create new frame and launch mu4e
        (let* ((frame (make-frame '((name . "mu4e")
                                  (width . 100)
                                  (height . 40)))))
        (select-frame-set-input-focus frame)
        (with-selected-frame frame
          (mu4e)
          (set-window-dedicated-p (selected-window) t))))))

;; Use bbdb for email contacts configuration.
(use-package bbdb
      :defer t )

(setq bbdb-file "~/.config/emacs-common/bbdb")
(require 'bbdb)
(require 'bbdb-com)
(bbdb-initialize 'mu4e 'message)

(setq mu4e-use-bbdb t)

(bbdb-mua-auto-update-init 'mu4e)

(setq message-completion-alist
    '((message-to . bbdb-complete-mail)
      (message-cc . bbdb-complete-mail)
      (message-bcc . bbdb-complete-mail)))

(define-key message-mode-map (kbd "TAB") 'bbdb-complete-mail)
</pre>
</div>
</div>
</div>
<div id="outline-container-org0a47733" class="outline-2">
<h2 id="org0a47733"><span class="section-number-2">8.</span> Dev Environment</h2>
<div class="outline-text-2" id="text-8">
<p>
My dev envrionments.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package typescript-mode
  :mode "\\.ts\\'")

(use-package python-mode
  :hook (python-mode . eglot-ensure))

(use-package pyvenv
  :config (pyvenv-mode 1))

(use-package projectile
  :diminish projectile-mode
  :config (projectile-mode)
  :custom ((projectile-completion-system 'ivy))
  :bind-keymap
  ("C-c p" . projectile-command-map)
  :init
  (when (file-directory-p "~/Documents/Code")
    (setq projectile-project-search-path '("~/Documents/Code")))
  (setq projectile-switch-project-action #'projectile-dired))

(use-package counsel-projectile
  :config (counsel-projectile-mode))

(use-package rainbow-delimiters
  :hook (prog-mode . rainbow-delimiters-mode))

(use-package request
:ensure t)

(require 'request)
(require 'json)

;; ChatGPT AI integration.
(setq chatgpt-shell-save-session t)
(global-set-key (kbd "C-c g") #'chatgpt-shell)

(setq chatgpt-shell-openai-key "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")

(setq chatgpt-shell-anthropic-key "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")

(setq chatgpt-shell-google-key "AIzaSyDkF0ZNBH208yLG48x_iv6kDVk0pjo6g3E")
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbe6fb47" class="outline-2">
<h2 id="orgbe6fb47"><span class="section-number-2">9.</span> System &amp; OS Integration</h2>
<div class="outline-text-2" id="text-9">
<p>
System / OS integration that might change across hardware /OS's etc.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp" id="orgaec5f07">(cond
 ((string= "archlinux" "archlinux")
  "(setq dired-listing-switches \"-alh --group-directories-first\")")
 ((string= "archlinux" "macos")
  "(setq dired-listing-switches \"-alh\")")
 (t "Unknown OS"))
</pre>
</div>

<p>
Dired configurations.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package dired
  :ensure nil
  :commands (dired dired-jump)
  :bind (("C-x C-j" . dired-jump)))

(setq dired-listing-switches "-alh --group-directories-first")

(use-package all-the-icons-dired
  :hook (dired-mode . all-the-icons-dired-mode))

;; Launch apps based on content.
(use-package dired-open
  :config
  (setq dired-open-extensions
        '(("png" . "feh")
          ("jpg" . "feh")
          ("pdf" . "zathura")
          ("mp4" . "mpv")
          ("mkv" . "mpv")
          ("html" . "floorp"))))

(use-package dired-hide-dotfiles
  :hook (dired-mode . dired-hide-dotfiles-mode))

;; Must have dired extensions
(use-package peep-dired
  :ensure t
  :bind (:map dired-mode-map
              ("P" . peep-dired))
  :hook (peep-dired-mode . (lambda () (setq-local image-dired-display-image-buffer 'other))))

(use-package dired-subtree
  :ensure t
  :bind (:map dired-mode-map
              ("&lt;tab&gt;" . dired-subtree-toggle)))
</pre>
</div>

<p>
Terminal
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(use-package vterm
  :commands vterm
  :bind ("C-c v" . vterm)
  :config
  (setq vterm-shell "/usr/bin/fish")
  (setq vterm-max-scrollback 10000))
</pre>
</div>
</div>
</div>
<div id="outline-container-org1ccc26f" class="outline-2">
<h2 id="org1ccc26f"><span class="section-number-2">10.</span> My Functions</h2>
<div class="outline-text-2" id="text-10">
<p>
This section is dedicated to my functions. These will eventually be generated based on target environment.
</p>

<p>
Niri literate config.kdl tangle and deploy. This function will evaluate
and tangle the niri config.kdl and deploy it into the correct niri
directory, with included rollback capability.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun niri-babel-build-and-deploy ()
  "Execute all necessary blocks (except kdl), tangle, and deploy to ~/.config/niri/config.kdl"
  (interactive)
  (let* ((org-file "~/projects/niri_babel_config/niri_config.org")
         (output-dir "~/projects/niri_babel_config/")
         (output-file (expand-file-name "config.kdl" output-dir))
         (target-file "~/.config/niri/config.kdl"))
    (with-current-buffer (find-file-noselect org-file)
      ;; Execute only non-KDL blocks
      (org-babel-map-src-blocks org-file
        (let* ((info (org-babel-get-src-block-info))
               (lang (nth 0 info)))
          (unless (string= lang "kdl")
            (org-babel-execute-src-block))))
      ;; Tangle everything
      (org-babel-tangle)
      ;; Copy the output
      (when (file-exists-p output-file)
        (copy-file output-file target-file t)
        (message "Tangled and copied config.kdl to %s" target-file)))))
</pre>
</div>

<p>
This is a prototype / test / learning function. To use it add this function to
emacsclient startup and it will display thumbnails for the screenshots directory,
allow you to select a single thumbnail, copy it to the clipboard and exit.
This is used in niri with a similar function using feh. The goal was to see
how close emacs could reproduce the feh functionality. The results are pretty
good and this is currently wired as a keybind in niri as is feh.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(require 'image-dired)

(defun my/image-dired-copy-and-exit ()
  "Copy image under point in image-dired and exit Emacsclient."
  (interactive)
  (let* ((file (image-dired-original-file-name))
         (copy-prog (or (executable-find "wl-copy")
                        (executable-find "xclip"))))
    (unless copy-prog
      (error "No clipboard utility (wl-copy or xclip) found"))
    (unless (and file (file-exists-p file))
      (error "No image found under cursor"))
    (with-temp-buffer
      (insert-file-contents-literally file)
      (call-process-region
       (point-min) (point-max)
       copy-prog nil nil nil "-t" "image/png"))
    (save-buffers-kill-terminal)))

(with-eval-after-load 'image-dired
  ;; `m` to copy and exit
  (define-key image-dired-thumbnail-mode-map (kbd "m") #'my/image-dired-copy-and-exit)
  ;; `q` to just quit
  (define-key image-dired-thumbnail-mode-map (kbd "q")
    (lambda ()
      (interactive)
      (save-buffers-kill-terminal))))

(defun my/image-picker-thumbnail-mode ()
  "Launch thumbnail-only image picker. Press `m` to copy &amp; exit."
  (interactive)
  (let ((dir "~/Pictures/screenshots/"))
    ;; Save current window configuration, run image-dired
    (image-dired dir)
    ;; Force delete all windows except the one showing *image-dired*
    (let ((image-buffer "*image-dired*"))
      (dolist (win (window-list))
        (unless (eq (window-buffer win) (get-buffer image-buffer))
          (delete-window win)))
      (select-window (get-buffer-window image-buffer)))))
</pre>
</div>

<p>
Show the server name that this emacsclient is connected to.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">;; Show the server name that this emacsclient is connected to.
(defun show-current-server-name ()
  "Display the name of the Emacs server this client is connected to."
  (interactive)
  (message "Connected to Emacs server: %s" server-name))

;; Then bind it in the startup hook
(add-hook 'emacs-startup-hook
          (lambda ()
            (global-set-key (kbd "&lt;f12&gt;") #'show-current-server-name)))
</pre>
</div>

<p>
List niri active windows.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">;; Output niri-windows to new buffer
(defun niri-windows ()
  "Show Niri windows in a new buffer."
  (interactive)
  (let ((buf (get-buffer-create "*niri-windows*")))
    (with-current-buffer buf
      (read-only-mode -1)
      (erase-buffer)
      (call-process "~/projects/niri_toolkit/niri-windows.py" nil buf)
      (goto-char (point-min))
      (read-only-mode 1))
    (pop-to-buffer buf)))
</pre>
</div>

<p>
Connect to niri IPC and display events in a buffer.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">;;Output niri-event-stream via IPC to new buffer
(defun niri-event-stream ()
  "Show the Niri event stream in a new buffer."
  (interactive)
  (let ((buf (get-buffer-create "*Niri Event Stream*")))
    (apply 'make-comint-in-buffer
           "Niri Event Stream"
           buf
           (expand-file-name "~/projects/niri_toolkit/niri-tail-event-stream.py")
           nil)
    (pop-to-buffer buf)))
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfe213cd" class="outline-2">
<h2 id="orgfe213cd"><span class="section-number-2">11.</span> Table of Contents / Manifest</h2>
<div class="outline-text-2" id="text-11">
<p>
A high-level view of config modules.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Section</th>
<th scope="col" class="org-left">ID</th>
<th scope="col" class="org-left">Tangle Path</th>
<th scope="col" class="org-left">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Environment</td>
<td class="org-left">env-setup</td>
<td class="org-left">./modules/env.el</td>
<td class="org-left">Shared values</td>
</tr>

<tr>
<td class="org-left">Core</td>
<td class="org-left">core</td>
<td class="org-left">./modules/core.el</td>
<td class="org-left">Emacs core</td>
</tr>

<tr>
<td class="org-left">Core-Extensions</td>
<td class="org-left">core-extensions</td>
<td class="org-left">./modules/core-extensions.el</td>
<td class="org-left">Extension to emacs core</td>
</tr>

<tr>
<td class="org-left">UI</td>
<td class="org-left">ui-config</td>
<td class="org-left">./modules/ui.el</td>
<td class="org-left">UI (Theme, font, etc.)</td>
</tr>

<tr>
<td class="org-left">Org</td>
<td class="org-left">org-basic</td>
<td class="org-left">./modules/org.el</td>
<td class="org-left">Org</td>
</tr>

<tr>
<td class="org-left">Dev</td>
<td class="org-left">dev-env</td>
<td class="org-left">./modules/dev.el</td>
<td class="org-left">Dev tooling</td>
</tr>

<tr>
<td class="org-left">System &amp; OS Integration</td>
<td class="org-left">system-os-env</td>
<td class="org-left">./modules/system-os.el</td>
<td class="org-left">System &amp; OS Utilities</td>
</tr>

<tr>
<td class="org-left">Email</td>
<td class="org-left">email</td>
<td class="org-left">./modules/email.el</td>
<td class="org-left">Email</td>
</tr>

<tr>
<td class="org-left">My Functions</td>
<td class="org-left">my-functions</td>
<td class="org-left">./modules/my-functions.el</td>
<td class="org-left">My custom functions</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Mike Burns</p>
<p class="date">Created: 2025-08-03 Sun 16:02</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
